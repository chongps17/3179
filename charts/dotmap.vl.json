{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": {"text": "Fire detections in Australia between 1 August 2019 to 30 September 2019",
  "anchor": "middle", "offset": 15, "fontSize": 16}, 
  "vconcat": [
    {
      "width": 800,
      "height": 700,
      "projection": {
        "type": "albers",
        "parallels": [-18, -36],
        "rotate": [-130, 0]
      },
      "layer": [
        {
          "data": {
            "url": "https://raw.githubusercontent.com/chongps17/3179/refs/heads/main/data/ne_10m_admin_1_states_provinces.json",
            "format": { "type": "topojson", "feature": "ne_10m_admin_1_states_provinces" }
          },
          "transform": [{ "filter": "datum.properties.adm0_a3 == 'AUS'" }],
          "mark": { "type": "geoshape", "fill": "lightgray", "stroke": "white" }
        },
        {
          "data": {
            "url": "https://raw.githubusercontent.com/chongps17/3179/main/data/fire_archive_M6_96619.csv"
          },
          "transform": [
            { "filter": { "param": "dateBrush" } }   
          ],
          "mark": { "type": "circle", "opacity": 0.85, "stroke": "white", "strokeWidth": 0.35},
          "encoding": {
            "longitude": { "field": "longitude", "type": "quantitative" },
            "latitude":  { "field": "latitude",  "type": "quantitative" },
            "color": { "field": "brightness", "type": "quantitative", "scale": { "scheme": "reds", "domain": [200, 500]}, "title": "Brightness (K)"},
            "size": { "field": "frp", "type": "quantitative", "scale": { "range": [50, 1500] }, "title": "Fire Radiative Power (FRP)" },
            "tooltip": [
              {"field":"acq_date", "timeUnit": "utcyearmonthdate", "title": "Date"},
              {"field":"brightness", "title": "Brightness (K)"}, {"field":"frp", "title": "Fire Radiative Power (FRP)"}, {"field": "satellite", "title": "Satellite"},
              {"field":"latitude", "title": "Latitude"}, {"field":"longitude", "title": "Longitude"}
            ]
          }
        }
      ]
    },

    {
      "width": 800,
      "height": 100,
      "title": {"text": "Use this bar chart to filter out the map based on dates", 
    "anchor": "middle", "offset": 15, "fontSize": 14},
      "data": { "url": "https://raw.githubusercontent.com/chongps17/3179/main/data/fire_archive_M6_96619.csv" },
      "params": [
        {
          "name": "dateBrush",
          "select": { "type": "interval", "encodings": ["x"] }
        }
      ],
      "mark": {"type": "bar",
              "color": "#da4f45"},
      "encoding": {
        "x": {
          "field": "acq_date",
          "type": "temporal",
          "title": "Range of dates recorded",
          "timeUnit": "utcyearmonthdate"
        },
        "y": { "aggregate": "count", "title": "Count of fires" },
        "tooltip": [
          {"field":"acq_date","type":"temporal","title":"Date"},
          {"aggregate":"count","title":"Detections", "format": ","}
        ]
      }
    }
  ]
}
